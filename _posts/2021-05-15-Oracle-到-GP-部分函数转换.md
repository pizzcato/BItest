---
title: Oracle 和 GP 部分函数转换
author: pizzcato
date: 2021-5-15 17:27:55 +0800
categories: [datebase,greenplum]
image:
  src: https://pizzcato.github.io/BItest/assets/img/database/oracle2gp/oracle2gp.png
---

## Oracle 到 GP 部分函数转换  

>[https://blog.csdn.net/xufan601391682/article/details/90476856](https://blog.csdn.net/xufan601391682/article/details/90476856)  

### 对照表

|oracle| gp| 说明|
|-|-|-|
|instr( string1, string2 )|strpos(string1,string2)<br>position(string2  in  string1)|判断s2在s1中的位置<br>在gp中如果安装了oracle扩展也可以使用**instr**|
|[substr( string, start_position, [ length ] )](https://docs.oracle.com/cd/B19306_01/server.102/b14200/functions162.htm)|substr( string, start_position, [ length ] )|oracle 可以用0或1表示起始，gp中只能用1<br>此外在oracle中`start_position`为负数则代表从后往前计数,<br>而gp没有这个特性,`start_position`代表的是字符串的index,负数则为字符串前的位置,也就是空字符串<br >e.g:<br>![7](https://pizzcato.github.io/BItest/assets/img/database/oracle2gp/7.png)<br>从-1开始取3位,-1和0都是空字符串,所以最后的结果只有`1`这一位|
|[REGEXP_SUBSTR](https://docs.oracle.com/cd/B12037_01/server.101/b10759/functions116.htm)<br>REGEXP_SUBSTR(<span style='color:purple'>string</span>,<span style='color:green'>pattern</span>[,<span style='color:goldenrod'>start_position</span>[,<span style='color:blue'>nth_appearance</span>[,<span style='color:red'>match_parameter</span><br>[,sub_expression ] ] ] ] )<br>exp:regexp_substr(<span style='color:purple'>'ABCabc'</span>,<span style='color:green'>'AB'</span>,<span style='color:goldenrod'>1</span>,<span style='color:blue'>2</span>,<span style='color:red'>'i'</span>)<br>可选**匹配模式**:<br>![2](https://pizzcato.github.io/BItest/assets/img/database/oracle2gp/2.png)|regexp_matches /SUBSTRING/regexp_match<br>(select regexp_matches(<span style='color:purple'>string</span>,<span style='color:green'>pattern</span>,'g<span style='color:red'>match_parameter</span>') <br>limit 1 offset <span style='color:blue'>nth_appearance-1</span>)[1]<br>exp:(select regexp_matches(<span style='color:purple'>'ABCabc'</span>,<span style='color:green'>'AB'</span>,'**g**<span style='color:red'>i</span>') limit 1 offset <span style='color:blue'>1</span> )[1]<br> 匹配模式,其中**g**代表全局匹配[^1]<br>![10](https://pizzcato.github.io/BItest/assets/img/database/oracle2gp/10.png)|`substring`用于返回第一次匹配的对象,<br>`regexp_match`同样也是返回第一次匹配的对象<br>`regexp_matches`的g模式可以一次性以text[]的方式返回所有的匹配对象|

[^1]:全局匹配表示匹配所有结果  
